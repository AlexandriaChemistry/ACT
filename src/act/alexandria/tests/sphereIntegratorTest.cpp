/*
 * This source file is part of the Alexandria program.
 *
 * Copyright (C) 2022,2023
 *
 * Developers:
 *             Mohammad Mehdi Ghahremanpour,
 *             Julian Marrades,
 *             Marie-Madeleine Walz,
 *             Paul J. van Maaren,
 *             David van der Spoel (Project leader)
 *
 * This program is free software; you can redistribute it and/or
 * modify it under the terms of the GNU General Public License
 * as published by the Free Software Foundation; either version 2
 * of the License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor,
 * Boston, MA  02110-1301, USA.
 */

/*! \internal \brief
 * Implements part of the alexandria program.
 * \author David van der Spoel <david.vanderspoel@icm.uu.se>
 */

#include "actpre.h"

#include <cmath>

#include <gtest/gtest.h>

#include "act/alexandria/b2data.h"

#include "testutils/cmdlinetest.h"
#include "testutils/refdata.h"
#include "testutils/testasserts.h"
#include "testutils/testfilemanager.h"

namespace alexandria
{

namespace
{

class SphereIntegratorTest : public gmx::test::CommandLineTestBase
{
protected:
    void test(const std::vector<std::pair<double, double>> &data,
              const double expectedValue)
    {
        gmx::test::TestReferenceChecker checker_(this->rootChecker());
        auto tolerance = gmx::test::relativeToleranceAsFloatingPoint(1.0, 5e-2);
        checker_.setDefaultTolerance(tolerance);
        // Test integration routine.
        std::vector<double> dB;
        double              B = 0;
        for(size_t i = 0; i < data.size()-1; i++)
        {
            double ddB = sphereIntegrator(data[i].first, data[i+1].first, data[i].second, data[i+1].second);
            dB.push_back(ddB);
            B += ddB;
        }
        checker_.checkReal(B, "Numerical Integral");
        checker_.checkReal(expectedValue, "Analytical Integral");
        checker_.checkSequence(dB.begin(), dB.end(), "Components");
    }
};

TEST_F (SphereIntegratorTest, Constant)
{
    std::vector<std::pair<double, double>> data;
    for(size_t i = 0; i <= 100; i++)
    {
        data.push_back({ i*0.01, 1.0 });
    }
    // Expected analytical integral 4/3 Pi r^3
    double expected = 4*M_PI/3.0;
    test(data, expected);
}

TEST_F (SphereIntegratorTest, Exponential)
{
    std::vector<std::pair<double, double>> data;
    for(size_t i = 0; i <= 100; i++)
    {
        double x = i*0.01;
        data.push_back({ x, std::exp(-x) });
    }
    // Expected analytical integral (from Mathematica)
    // 4 (2 - 5/E) * Pi
    double expected = 4*M_PI*(2-5/std::exp(1));
    test(data, expected);
}

TEST_F (SphereIntegratorTest, ShiftedHyperbole)
{
    std::vector<std::pair<double, double>> data;
    for(size_t i = 0; i <= 100; i++)
    {
        double x = i*0.01;
        data.push_back({ x, 1.0/(1.0+x) });
    }
    // Expected analytical integral (from Mathematica)
    // 2 Pi (-1 + Log[4])
    double expected = (std::log(4.0)-1)*2*M_PI;
    test(data, expected);
}

TEST_F (SphereIntegratorTest, Cosine)
{
    std::vector<std::pair<double, double>> data;
    for(size_t i = 0; i <= 100; i++)
    {
        double x = i*0.01;
        data.push_back({ x, std::cos(x) });
    }
    // Expected analytical integral (from Mathematica)
    // Pi (8 Cos[1] - 4 Sin[1])
    double expected = (8*std::cos(1.0)-4*std::sin(1.0))*M_PI;
    test(data, expected);
}

TEST_F (SphereIntegratorTest, MayerArgon80)
{
    std::vector<std::pair<double, double>> data = {
        { 0.0, -1 },
        { 0.075, -1 },
        { 0.15, -1 },
        { 0.225, -1 },
        { 0.3, -1 },
        { 0.375, -1 },
        { 0.45, -1 },
        { 0.525, -1 },
        { 0.6, -1 },
        { 0.675, -1 },
        { 0.75, -1 },
        { 0.825, -1 },
        { 0.9, -1 },
        { 0.975, -1 },
        { 1.05, -1 },
        { 1.125, -1 },
        { 1.2, -1 },
        { 1.275, -1 },
        { 1.35, -1 },
        { 1.425, -1 },
        { 1.5, -1 },
        { 1.575, -1 },
        { 1.65, -1 },
        { 1.725, -1 },
        { 1.8, -1 },
        { 1.875, -1 },
        { 1.95, -1 },
        { 2.025, -1 },
        { 2.1, -1 },
        { 2.175, -1 },
        { 2.25, -1 },
        { 2.325, -1 },
        { 2.4, -1 },
        { 2.475, -1 },
        { 2.55, -1 },
        { 2.625, -1 },
        { 2.7, -1 },
        { 2.775, -1 },
        { 2.85, -1 },
        { 2.925, -1 },
        { 3, -1 },
        { 3.075, -0.99991 },
        { 3.15, -0.996615 },
        { 3.225, -0.959098 },
        { 3.3, -0.775646 },
        { 3.375, -0.291399 },
        { 3.45, 0.52104 },
        { 3.525, 1.49199 },
        { 3.6, 2.38094 },
        { 3.675, 3.02341 },
        { 3.75, 3.37388 },
        { 3.825, 3.47043 },
        { 3.9, 3.38415 },
        { 3.975, 3.18527 },
        { 4.05, 2.92891 },
        { 4.125, 2.65273 },
        { 4.2, 2.37994 },
        { 4.275, 2.12334 },
        { 4.35, 1.889 },
        { 4.425, 1.67881 },
        { 4.5, 1.49238 },
        { 4.575, 1.32811 },
        { 4.65, 1.18386 },
        { 4.725, 1.05738 },
        { 4.8, 0.946483 },
        { 4.875, 0.849164 },
        { 4.95, 0.763628 },
        { 5.025, 0.6883 },
        { 5.1, 0.621814 },
        { 5.175, 0.562993 },
        { 5.25, 0.510825 },
        { 5.325, 0.464443 },
        { 5.4, 0.423105 },
        { 5.475, 0.386172 },
        { 5.55, 0.353098 },
        { 5.625, 0.323412 },
        { 5.7, 0.296709 },
        { 5.775, 0.272638 },
        { 5.85, 0.250895 },
        { 5.925, 0.231218 },
        { 6, 0.213377 },
        { 6.075, 0.197171 },
        { 6.15, 0.182426 },
        { 6.225, 0.168987 },
        { 6.3, 0.156721 },
        { 6.375, 0.145507 },
        { 6.45, 0.135241 },
        { 6.525, 0.125829 },
        { 6.6, 0.11719 },
        { 6.675, 0.109249 },
        { 6.75, 0.10194 },
        { 6.825, 0.0952067 },
        { 6.9, 0.0889953 },
        { 6.975, 0.0832594 },
        { 7.05, 0.0779569 },
        { 7.125, 0.0730501 },
        { 7.2, 0.0685049 },
        { 7.275, 0.0642906 },
        { 7.35, 0.0603794 },
        { 7.425, 0.0567464 },
        { 7.5, 0.0533687 },
        { 7.575, 0.0502257 },
        { 7.65, 0.0472988 },
        { 7.725, 0.0445708 },
        { 7.8, 0.0420263 },
        { 7.875, 0.0396511 },
        { 7.95, 0.0374323 },
        { 8.025, 0.0353582 },
        { 8.1, 0.0334179 },
        { 8.175, 0.0316015 },
        { 8.25, 0.0299001 },
        { 8.325, 0.0283052 },
        { 8.4, 0.0268093 },
        { 8.475, 0.0254053 },
        { 8.55, 0.0240869 },
        { 8.625, 0.022848 },
        { 8.7, 0.0216831 },
        { 8.775, 0.0205873 },
        { 8.85, 0.0195558 },
        { 8.925, 0.0185844 },
        { 9, 0.017669 },
        { 9.075, 0.016806 },
        { 9.15, 0.015992 },
        { 9.225, 0.0152238 },
        { 9.3, 0.0144984 },
        { 9.375, 0.0138131 },
        { 9.45, 0.0131654 },
        { 9.525, 0.012553 },
        { 9.6, 0.0119737 },
        { 9.675, 0.0114254 },
        { 9.75, 0.0109063 },
        { 9.825, 0.0104145 },
        { 9.9, 0.00994845 },
        { 9.975, 0.00950661 },
        { 10.05, 0.00908755 },
        { 10.125, 0.00868992 },
        { 10.2, 0.00831249 },
        { 10.275, 0.00795407 },
        { 10.35, 0.00761359 },
        { 10.425, 0.00729002 },
        { 10.5, 0.00698241 },
        { 10.575, 0.00668986 },
        { 10.65, 0.00641153 },
        { 10.725, 0.00614663 },
        { 10.8, 0.00589443 },
        { 10.875, 0.00565424 },
        { 10.95, 0.00542541 },
        { 11.025, 0.00520732 },
        { 11.1, 0.0049994 },
        { 11.175, 0.00480112 },
        { 11.25, 0.00461195 },
        { 11.325, 0.00443144 },
        { 11.4, 0.00425912 },
        { 11.475, 0.00409458 },
        { 11.55, 0.00393741 },
        { 11.625, 0.00378725 },
        { 11.7, 0.00364372 },
        { 11.775, 0.00350651 },
        { 11.85, 0.0033753 },
        { 11.925, 0.00324978 },
        { 12, 0.00312967 },
        { 12.075, 0.00301472 },
        { 12.15, 0.00290467 },
        { 12.225, 0.00279928 },
        { 12.3, 0.00269832 },
        { 12.375, 0.00260159 },
        { 12.45, 0.00250889 },
        { 12.525, 0.00242001 },
        { 12.6, 0.00233479 },
        { 12.675, 0.00225306 },
        { 12.75, 0.00217464 },
        { 12.825, 0.00209939 },
        { 12.9, 0.00202717 },
        { 12.975, 0.00195782 },
        { 13.05, 0.00189123 },
        { 13.125, 0.00182727 },
        { 13.2, 0.00176582 },
        { 13.275, 0.00170677 },
        { 13.35, 0.00165001 },
        { 13.425, 0.00159544 },
        { 13.5, 0.00154296 },
        { 13.575, 0.00149249 },
        { 13.65, 0.00144393 },
        { 13.725, 0.00139721 },
        { 13.8, 0.00135225 },
        { 13.875, 0.00130896 },
        { 13.95, 0.00126728 },
        { 14.025, 0.00122714 },
        { 14.1, 0.00118848 },
        { 14.175, 0.00115123 },
        { 14.25, 0.00111534 },
        { 14.325, 0.00108074 },
        { 14.4, 0.0010474 },
        { 14.475, 0.00101524 },
        { 14.55, 0.000984235 },
        { 14.625, 0.000954327 },
        { 14.7, 0.000925474 },
        { 14.775, 0.000897634 },
        { 14.85, 0.000870767 },
        { 14.925, 0.000844833 },
        { 15, 0.000819796 },
        { 15.075, 0.00079562 },
        { 15.15, 0.000772272 },
        { 15.225, 0.00074972 },
        { 15.3, 0.000727933 },
        { 15.375, 0.000706881 },
        { 15.45, 0.000686535 },
        { 15.525, 0.00066687 },
        { 15.6, 0.000647859 },
        { 15.675, 0.000629478 },
        { 15.75, 0.000611702 },
        { 15.825, 0.000594509 },
        { 15.9, 0.000577877 },
        { 15.975, 0.000561786 },
        { 16.05, 0.000546215 },
        { 16.125, 0.000531145 },
        { 16.2, 0.000516558 },
        { 16.275, 0.000502437 },
        { 16.35, 0.000488763 },
        { 16.425, 0.000475523 },
        { 16.5, 0.000462698 },
        { 16.575, 0.000450276 },
        { 16.65, 0.000438241 },
        { 16.725, 0.000426579 },
        { 16.8, 0.000415278 },
        { 16.875, 0.000404325 },
        { 16.95, 0.000393707 },
        { 17.025, 0.000383413 },
        { 17.1, 0.000373432 },
        { 17.175, 0.000363753 },
        { 17.25, 0.000354365 },
        { 17.325, 0.000345259 },
        { 17.4, 0.000336425 },
        { 17.475, 0.000327853 },
        { 17.55, 0.000319535 },
        { 17.625, 0.000311462 },
        { 17.7, 0.000303626 },
        { 17.775, 0.000296019 },
        { 17.85, 0.000288634 },
        { 17.925, 0.000281462 },
        { 18, 0.000274498 },
        { 18.075, 0.000267734 },
        { 18.15, 0.000261164 },
        { 18.225, 0.000254781 },
        { 18.3, 0.000248579 },
        { 18.375, 0.000242552 },
        { 18.45, 0.000236696 },
        { 18.525, 0.000231004 },
        { 18.6, 0.00022547 },
        { 18.675, 0.000220091 },
        { 18.75, 0.000214861 },
        { 18.825, 0.000209776 },
        { 18.9, 0.00020483 },
        { 18.975, 0.00020002 },
        { 19.05, 0.000195341 },
        { 19.125, 0.000190789 },
        { 19.2, 0.000186361 },
        { 19.275, 0.000182052 },
        { 19.35, 0.000177858 },
        { 19.425, 0.000173778 },
        { 19.5, 0.000169805 },
        { 19.575, 0.000165939 },
        { 19.65, 0.000162175 },
        { 19.725, 0.00015851 },
        { 19.8, 0.000154941 },
        { 19.875, 0.000151465 },
        { 19.95, 0.000148081 },
        { 20.025, 0.000144784 },
        { 20.1, 0.000141572 },
        { 20.175, 0.000138444 },
        { 20.25, 0.000135395 },
        { 20.325, 0.000132425 },
        { 20.4, 0.000129531 },
        { 20.475, 0.00012671 },
        { 20.55, 0.00012396 },
        { 20.625, 0.00012128 },
        { 20.7, 0.000118667 },
        { 20.775, 0.00011612 },
        { 20.85, 0.000113636 },
        { 20.925, 0.000111214 },
        { 21, 0.000108852 },
        { 21.075, 0.000106548 },
        { 21.15, 0.000104301 },
        { 21.225, 0.000102109 },
        { 21.3, 9.99704e-05 },
        { 21.375, 9.78841e-05 },
        { 21.45, 9.58484e-05 },
        { 21.525, 9.38619e-05 },
        { 21.6, 9.19232e-05 },
        { 21.675, 9.00312e-05 },
        { 21.75, 8.81844e-05 },
        { 21.825, 8.63817e-05 },
        { 21.9, 8.46218e-05 },
        { 21.975, 8.29036e-05 },
        { 22.05, 8.12259e-05 },
        { 22.125, 7.95878e-05 },
        { 22.2, 7.7988e-05 },
        { 22.275, 7.64257e-05 },
        { 22.35, 7.48997e-05 },
        { 22.425, 7.34092e-05 },
        { 22.5, 7.19532e-05 },
        { 22.575, 7.05307e-05 },
        { 22.65, 6.9141e-05 },
        { 22.725, 6.7783e-05 },
        { 22.8, 6.64561e-05 },
        { 22.875, 6.51594e-05 },
        { 22.95, 6.38922e-05 },
        { 23.025, 6.26536e-05 },
        { 23.1, 6.14429e-05 },
        { 23.175, 6.02594e-05 },
        { 23.25, 5.91024e-05 },
        { 23.325, 5.79713e-05 },
        { 23.4, 5.68653e-05 },
        { 23.475, 5.57839e-05 },
        { 23.55, 5.47264e-05 },
        { 23.625, 5.36922e-05 },
        { 23.7, 5.26808e-05 },
        { 23.775, 5.16915e-05 },
        { 23.85, 5.07238e-05 },
        { 23.925, 4.97772e-05 },
        { 24, 4.88511e-05 },
        { 24.075, 4.7945e-05 },
        { 24.15, 4.70586e-05 },
        { 24.225, 4.61911e-05 },
        { 24.3, 4.53423e-05 },
        { 24.375, 4.45116e-05 },
        { 24.45, 4.36986e-05 },
        { 24.525, 4.29029e-05 },
        { 24.6, 4.2124e-05 },
        { 24.675, 4.13616e-05 },
        { 24.75, 4.06153e-05 },
        { 24.825, 3.98846e-05 },
        { 24.9, 3.91692e-05 },
        { 24.975, 3.84687e-05 },
        { 25.05, 3.77828e-05 },
        { 25.125, 3.71111e-05 },
        { 25.2, 3.64533e-05 },
        { 25.275, 3.5809e-05 },
        { 25.35, 3.51781e-05 },
        { 25.425, 3.456e-05 },
        { 25.5, 3.39546e-05 },
        { 25.575, 3.33615e-05 },
        { 25.65, 3.27805e-05 },
        { 25.725, 3.22112e-05 },
        { 25.8, 3.16534e-05 },
        { 25.875, 3.11069e-05 },
        { 25.95, 3.05714e-05 },
        { 26.025, 3.00465e-05 },
        { 26.1, 2.95322e-05 },
        { 26.175, 2.90281e-05 },
        { 26.25, 2.8534e-05 },
        { 26.325, 2.80497e-05 },
        { 26.4, 2.7575e-05 },
        { 26.475, 2.71096e-05 },
        { 26.55, 2.66533e-05 },
        { 26.625, 2.6206e-05 },
        { 26.7, 2.57674e-05 },
        { 26.775, 2.53374e-05 },
        { 26.85, 2.49157e-05 },
        { 26.925, 2.45021e-05 },
        { 27, 2.40966e-05 },
        { 27.075, 2.36988e-05 },
        { 27.15, 2.33087e-05 },
        { 27.225, 2.29261e-05 },
        { 27.3, 2.25508e-05 },
        { 27.375, 2.21826e-05 },
        { 27.45, 2.18215e-05 },
        { 27.525, 2.14671e-05 },
        { 27.6, 2.11195e-05 },
        { 27.675, 2.07784e-05 },
        { 27.75, 2.04437e-05 },
        { 27.825, 2.01153e-05 },
        { 27.9, 1.9793e-05 },
        { 27.975, 1.94768e-05 },
        { 28.05, 1.91664e-05 },
        { 28.125, 1.88618e-05 },
        { 28.2, 1.85628e-05 },
        { 28.275, 1.82693e-05 },
        { 28.35, 1.79812e-05 },
        { 28.425, 1.76984e-05 },
        { 28.5, 1.74208e-05 },
        { 28.575, 1.71482e-05 },
        { 28.65, 1.68807e-05 },
        { 28.725, 1.66179e-05 },
        { 28.8, 1.636e-05 },
        { 28.875, 1.61066e-05 },
        { 28.95, 1.58579e-05 },
        { 29.025, 1.56136e-05 },
        { 29.1, 1.53737e-05 },
        { 29.175, 1.51381e-05 },
        { 29.25, 1.49067e-05 },
        { 29.325, 1.46794e-05 },
        { 29.4, 1.44562e-05 },
        { 29.475, 1.42368e-05 },
        { 29.55, 1.40214e-05 },
        { 29.625, 1.38098e-05 },
        { 29.7, 1.36018e-05 },
        { 29.775, 1.33976e-05 },
        { 29.85, 1.31969e-05 },
        { 29.925, 1.29996e-05 },
        { 30, 1.28059e-05 },
        { 30.075, 1.26154e-05 },
        { 30.15, 1.24283e-05 },
        { 30.225, 1.22444e-05 },
        { 30.3, 1.20637e-05 },
        { 30.375, 1.18861e-05 },
        { 30.45, 1.17115e-05 },
        { 30.525, 1.15399e-05 },
        { 30.6, 1.13712e-05 },
        { 30.675, 1.12054e-05 },
        { 30.75, 1.10425e-05 },
        { 30.825, 1.08822e-05 },
        { 30.9, 1.07247e-05 },
        { 30.975, 1.05698e-05 },
        { 31.05, 1.04176e-05 },
        { 31.125, 1.02679e-05 },
        { 31.2, 1.01207e-05 },
        { 31.275, 9.9759e-06 },
        { 31.35, 9.83356e-06 },
        { 31.425, 9.69358e-06 },
        { 31.5, 9.55592e-06 },
        { 31.575, 9.42054e-06 },
        { 31.65, 9.28739e-06 },
        { 31.725, 9.15643e-06 },
        { 31.8, 9.02762e-06 },
        { 31.875, 8.90092e-06 },
        { 31.95, 8.77628e-06 },
        { 32.025, 8.65368e-06 },
        { 32.1, 8.53308e-06 },
        { 32.175, 8.41443e-06 },
        { 32.25, 8.2977e-06 },
        { 32.325, 8.18285e-06 },
        { 32.4, 8.06985e-06 },
        { 32.475, 7.95868e-06 },
        { 32.55, 7.84928e-06 },
        { 32.625, 7.74163e-06 },
        { 32.7, 7.63571e-06 },
        { 32.775, 7.53147e-06 },
        { 32.85, 7.42888e-06 },
        { 32.925, 7.32792e-06 },
        { 33, 7.22856e-06 },
        { 33.075, 7.13077e-06 },
        { 33.15, 7.03452e-06 },
        { 33.225, 6.93978e-06 },
        { 33.3, 6.84652e-06 },
        { 33.375, 6.75473e-06 },
        { 33.45, 6.66437e-06 },
        { 33.525, 6.57541e-06 },
        { 33.6, 6.48784e-06 },
        { 33.675, 6.40162e-06 },
        { 33.75, 6.31674e-06 },
        { 33.825, 6.23317e-06 },
        { 33.9, 6.15088e-06 },
        { 33.975, 6.06986e-06 },
        { 34.05, 5.99008e-06 },
        { 34.125, 5.91152e-06 },
        { 34.2, 5.83417e-06 },
        { 34.275, 5.75799e-06 },
        { 34.35, 5.68296e-06 },
        { 34.425, 5.60908e-06 },
        { 34.5, 5.53632e-06 },
        { 34.575, 5.46465e-06 },
        { 34.65, 5.39406e-06 },
        { 34.725, 5.32454e-06 },
        { 34.8, 5.25605e-06 },
        { 34.875, 5.1886e-06 },
        { 34.95, 5.12215e-06 },
        { 35.025, 5.05669e-06 },
        { 35.1, 4.99221e-06 },
        { 35.175, 4.92868e-06 },
        { 35.25, 4.86609e-06 },
        { 35.325, 4.80443e-06 },
        { 35.4, 4.74368e-06 },
        { 35.475, 4.68383e-06 },
        { 35.55, 4.62485e-06 },
        { 35.625, 4.56674e-06 },
        { 35.7, 4.50947e-06 },
        { 35.775, 4.45305e-06 },
        { 35.85, 4.39744e-06 },
        { 35.925, 4.34265e-06 },
        { 36, 4.28865e-06 },
        { 36.075, 4.23543e-06 },
        { 36.15, 4.18298e-06 },
        { 36.225, 4.13128e-06 },
        { 36.3, 4.08033e-06 },
        { 36.375, 4.03011e-06 },
        { 36.45, 3.98061e-06 },
        { 36.525, 3.93182e-06 },
        { 36.6, 3.88373e-06 },
        { 36.675, 3.83632e-06 },
        { 36.75, 3.78958e-06 },
        { 36.825, 3.74351e-06 },
        { 36.9, 3.69809e-06 },
        { 36.975, 3.65331e-06 },
        { 37.05, 3.60916e-06 },
        { 37.125, 3.56563e-06 },
        { 37.2, 3.52271e-06 },
        { 37.275, 3.4804e-06 },
        { 37.35, 3.43868e-06 },
        { 37.425, 3.39754e-06 },
        { 37.5, 3.35697e-06 },
        { 37.575, 3.31697e-06 },
        { 37.65, 3.27752e-06 },
        { 37.725, 3.23862e-06 },
        { 37.8, 3.20025e-06 },
        { 37.875, 3.16242e-06 },
        { 37.95, 3.1251e-06 },
        { 38.025, 3.0883e-06 },
        { 38.1, 3.052e-06 },
        { 38.175, 3.0162e-06 },
        { 38.25, 2.98089e-06 },
        { 38.325, 2.94606e-06 },
        { 38.4, 2.91171e-06 },
        { 38.475, 2.87782e-06 },
        { 38.55, 2.84439e-06 },
        { 38.625, 2.81141e-06 },
        { 38.7, 2.77888e-06 },
        { 38.775, 2.74678e-06 },
        { 38.85, 2.71512e-06 },
        { 38.925, 2.68388e-06 },
        { 39, 2.65306e-06 },
        { 39.075, 2.62265e-06 },
        { 39.15, 2.59265e-06 },
        { 39.225, 2.56305e-06 },
        { 39.3, 2.53384e-06 },
        { 39.375, 2.50502e-06 },
        { 39.45, 2.47658e-06 },
        { 39.525, 2.44852e-06 },
        { 39.6, 2.42083e-06 },
        { 39.675, 2.3935e-06 },
        { 39.75, 2.36653e-06 },
        { 39.825, 2.33992e-06 },
        { 39.9, 2.31365e-06 },
        { 39.975, 2.28773e-06 },
        { 40.05, 2.26214e-06 },
        { 40.125, 2.23689e-06 },
        { 40.2, 2.21197e-06 },
        { 40.275, 2.18737e-06 },
        { 40.35, 2.16309e-06 },
        { 40.425, 2.13912e-06 },
        { 40.5, 2.11546e-06 },
        { 40.575, 2.09211e-06 },
        { 40.65, 2.06905e-06 },
        { 40.725, 2.0463e-06 },
        { 40.8, 2.02383e-06 },
        { 40.875, 2.00165e-06 },
        { 40.95, 1.97975e-06 },
        { 41.025, 1.95814e-06 },
        { 41.1, 1.9368e-06 },
        { 41.175, 1.91573e-06 },
        { 41.25, 1.89492e-06 },
        { 41.325, 1.87438e-06 },
        { 41.4, 1.8541e-06 },
        { 41.475, 1.83407e-06 },
        { 41.55, 1.8143e-06 },
        { 41.625, 1.79477e-06 },
        { 41.7, 1.77549e-06 },
        { 41.775, 1.75645e-06 },
        { 41.85, 1.73765e-06 },
        { 41.925, 1.71908e-06 },
        { 42, 1.70074e-06 },
        { 42.075, 1.68264e-06 },
        { 42.15, 1.66475e-06 },
        { 42.225, 1.64709e-06 },
        { 42.3, 1.62964e-06 },
        { 42.375, 1.61241e-06 },
        { 42.45, 1.5954e-06 },
        { 42.525, 1.57859e-06 },
        { 42.6, 1.56199e-06 },
        { 42.675, 1.54559e-06 },
        { 42.75, 1.52939e-06 },
        { 42.825, 1.51339e-06 },
        { 42.9, 1.49758e-06 },
        { 42.975, 1.48197e-06 },
        { 43.05, 1.46655e-06 },
        { 43.125, 1.45131e-06 },
        { 43.2, 1.43626e-06 },
        { 43.275, 1.42139e-06 },
        { 43.35, 1.4067e-06 },
        { 43.425, 1.39218e-06 },
        { 43.5, 1.37784e-06 },
        { 43.575, 1.36367e-06 },
        { 43.65, 1.34968e-06 },
        { 43.725, 1.33584e-06 },
        { 43.8, 1.32218e-06 },
        { 43.875, 1.30868e-06 },
        { 43.95, 1.29533e-06 },
        { 44.025, 1.28215e-06 },
        { 44.1, 1.26912e-06 },
        { 44.175, 1.25625e-06 },
        { 44.25, 1.24353e-06 },
        { 44.325, 1.23096e-06 },
        { 44.4, 1.21853e-06 },
        { 44.475, 1.20625e-06 },
        { 44.55, 1.19412e-06 },
        { 44.625, 1.18213e-06 },
        { 44.7, 1.17028e-06 },
        { 44.775, 1.15857e-06 },
        { 44.85, 1.14699e-06 },
        { 44.925, 1.13555e-06 },
        { 45, 1.12424e-06 },
        { 45.075, 1.11306e-06 },
        { 45.15, 1.10202e-06 },
        { 45.225, 1.0911e-06 },
        { 45.3, 1.0803e-06 },
        { 45.375, 1.06963e-06 },
        { 45.45, 1.05909e-06 },
        { 45.525, 1.04866e-06 },
        { 45.6, 1.03835e-06 },
        { 45.675, 1.02817e-06 },
        { 45.75, 1.01809e-06 },
        { 45.825, 1.00814e-06 },
        { 45.9, 9.98294e-07 },
        { 45.975, 9.88563e-07 },
        { 46.05, 9.78942e-07 },
        { 46.125, 9.6943e-07 },
        { 46.2, 9.60026e-07 },
        { 46.275, 9.50728e-07 },
        { 46.35, 9.41535e-07 },
        { 46.425, 9.32445e-07 },
        { 46.5, 9.23458e-07 },
        { 46.575, 9.14571e-07 },
        { 46.65, 9.05784e-07 },
        { 46.725, 8.97096e-07 },
        { 46.8, 8.88504e-07 },
        { 46.875, 8.80009e-07 },
        { 46.95, 8.71608e-07 },
        { 47.025, 8.633e-07 },
        { 47.1, 8.55085e-07 },
        { 47.175, 8.46961e-07 },
        { 47.25, 8.38926e-07 },
        { 47.325, 8.30981e-07 },
        { 47.4, 8.23123e-07 },
        { 47.475, 8.15351e-07 },
        { 47.55, 8.07666e-07 },
        { 47.625, 8.00064e-07 },
        { 47.7, 7.92546e-07 },
        { 47.775, 7.8511e-07 },
        { 47.85, 7.77755e-07 },
        { 47.925, 7.70481e-07 },
        { 48, 7.63286e-07 },
        { 48.075, 7.56169e-07 },
        { 48.15, 7.4913e-07 },
        { 48.225, 7.42166e-07 },
        { 48.3, 7.35279e-07 },
        { 48.375, 7.28465e-07 },
        { 48.45, 7.21725e-07 },
        { 48.525, 7.15058e-07 },
        { 48.6, 7.08463e-07 },
        { 48.675, 7.01938e-07 },
        { 48.75, 6.95484e-07 },
        { 48.825, 6.89098e-07 },
        { 48.9, 6.82781e-07 },
        { 48.975, 6.76531e-07 },
        { 49.05, 6.70348e-07 },
        { 49.125, 6.64231e-07 },
        { 49.2, 6.58179e-07 },
        { 49.275, 6.52191e-07 },
        { 49.35, 6.46267e-07 },
        { 49.425, 6.40405e-07 },
        { 49.5, 6.34605e-07 },
        { 49.575, 6.28866e-07 },
        { 49.65, 6.23188e-07 },
        { 49.725, 6.1757e-07 },
        { 49.8, 6.1201e-07 },
        { 49.875, 6.06509e-07 },
        { 49.95, 6.01065e-07 },
        { 50.025, 5.95679e-07 },
        { 50.1, 5.90348e-07 },
        { 50.175, 5.85073e-07 },
        { 50.25, 5.79853e-07 },
        { 50.325, 5.74688e-07 },
        { 50.4, 5.69576e-07 },
        { 50.475, 5.64517e-07 },
        { 50.55, 5.5951e-07 },
        { 50.625, 5.54555e-07 },
        { 50.7, 5.49651e-07 },
        { 50.775, 5.44797e-07 },
        { 50.85, 5.39994e-07 },
        { 50.925, 5.3524e-07 },
        { 51, 5.30534e-07 },
        { 51.075, 5.25877e-07 },
        { 51.15, 5.21268e-07 },
        { 51.225, 5.16705e-07 },
        { 51.3, 5.12189e-07 },
        { 51.375, 5.07719e-07 },
        { 51.45, 5.03295e-07 },
        { 51.525, 4.98915e-07 },
        { 51.6, 4.9458e-07 },
        { 51.675, 4.90289e-07 },
        { 51.75, 4.86041e-07 },
        { 51.825, 4.81835e-07 },
        { 51.9, 4.77673e-07 },
        { 51.975, 4.73552e-07 },
        { 52.05, 4.69473e-07 },
        { 52.125, 4.65434e-07 },
        { 52.2, 4.61436e-07 },
        { 52.275, 4.57478e-07 },
        { 52.35, 4.5356e-07 },
        { 52.425, 4.4968e-07 },
        { 52.5, 4.4584e-07 },
        { 52.575, 4.42037e-07 },
        { 52.65, 4.38273e-07 },
        { 52.725, 4.34545e-07 },
        { 52.8, 4.30855e-07 },
        { 52.875, 4.27201e-07 },
        { 52.95, 4.23583e-07 },
        { 53.025, 4.20001e-07 },
        { 53.1, 4.16454e-07 }
    };
    // Expected number from xmgrace
    double expected = 845.988;
    test(data, expected);
}

// #endif

} // namespace

} // namespace alexandria
